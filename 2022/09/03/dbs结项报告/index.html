<!DOCTYPE html><html lang=zh-CN data-default-color-scheme=auto><head><meta charset=UTF-8><link rel=apple-touch-icon sizes=76x76 href=/img/favicon.png><link rel=icon href=/img/favicon.png><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv=x-ua-compatible content="ie=edge"><meta http-equiv=Content-Security-Policy content="default-src 'none'; form-action 'none'; base-uri 'self'; img-src 'self' imagebed.torch-fan.site img1.imgtp.com s1.ax1x.com s1.328888.xyz; script-src 'self' lib.baomitu.com at.alicdn.com utteranc.es 'nonce-1' 'nonce-2' 'nonce-3' 'nonce-4' 'nonce-5' 'nonce-6' 'nonce-7' 'nonce-8' 'nonce-9' 'nonce-10' 'nonce-11' 'nonce-12' 'nonce-13' 'nonce-14'; style-src 'self' 'unsafe-inline' at.alicdn.com lib.baomitu.com; media-src 'self' blob:; worker-src 'self' blob:; object-src 'self'; connect-src 'self'; font-src 'self' lib.baomitu.com at.alicdn.com data:; frame-src 'self' utteranc.es ; "><meta name=theme-color content=#2f4154><meta name=author content=Torch-Fan><meta name=keywords content=""><meta name=description content="ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°å¯åŠ¨å¾®å‹è™šæ‹Ÿæœº        1. ğŸ“½ é¡¹ç›®å®ç°æ–¹æ¡ˆç ”ç©¶:  å®ç°æ–¹æ¡ˆç»™å‡ºæ˜¯ä¸ºäº†æä¾›å¯å¤ç°æ€§     é…ç½® æè¿°     å¤„ç†å™¨ AMDÂ® Ryzen 7 4800h with radeon graphics Ã— 16   å†…å­˜ 32g   æ˜¾å¡ NVIDIA Corporation TU117M [GeForce GTX 1650 Ti Mobile] &amp;#x2F; NVIDIA"><title>dbsç»“é¡¹æŠ¥å‘Š - Torch-Fan</title><link rel=stylesheet href=https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css><link rel=stylesheet href=https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css><link rel=stylesheet href=https://lib.baomitu.com/hint.css/2.7.0/hint.min.css><link rel=stylesheet href=https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css><link rel=stylesheet href=https://lib.baomitu.com/KaTeX/0.15.2/katex.min.css><link rel=stylesheet href=//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css><link rel=stylesheet href=/css/font.css><link rel=stylesheet href=/css/main.css><link id=highlight-css rel=stylesheet href=/css/highlight.css><link id=highlight-css-dark rel=stylesheet href=/css/highlight-dark.css><script id=fluid-configs nonce=4>var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var dntVal,CONFIG={hostname:"www.torch-fan.site",root:"/",version:"1.9.0",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"};CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src=/js/utils.js></script><script src=/js/color-schema.js></script><meta name=generator content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="Torch-Fan" type="application/atom+xml">
</head><body><header><div class=header-inner style=height:70vh><nav id=navbar class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class=container><a class=navbar-brand href=/ ><strong>Torch-Fan</strong> </a><button id=navbar-toggler-btn class=navbar-toggler type=button data-toggle=collapse data-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation"><div class=animated-icon><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav ml-auto text-center"><li class=nav-item id=search-btn><a class=nav-link target=_self href=javascript:; data-toggle=modal data-target=#modalSearch aria-label=Search>&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class=nav-item><a class=nav-link href=/ ><i class="iconfont icon-home-fill"></i> é¦–é¡µ</a></li><li class=nav-item><a class=nav-link href=/archives/ ><i class="iconfont icon-archive-fill"></i> å½’æ¡£</a></li><li class=nav-item><a class=nav-link href=/categories/ ><i class="iconfont icon-category-fill"></i> åˆ†ç±»</a></li><li class=nav-item><a class=nav-link href=/tags/ ><i class="iconfont icon-tags-fill"></i> æ ‡ç­¾</a></li><li class=nav-item><a class=nav-link href=/about/ ><i class="iconfont icon-user-fill"></i> å…³äº</a></li><li class=nav-item id=color-toggle-btn><a class=nav-link target=_self href=javascript:; aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id=color-toggle-icon></i>&nbsp;</a></li></ul></div></div></nav><div id=banner class=banner parallax=true style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class=full-bg-img><div class="mask flex-center" style=background-color:rgba(0,0,0,.3)><div class="banner-text text-center fade-in-up"><div class=h2><span id=subtitle data-typed-text=dbsç»“é¡¹æŠ¥å‘Š></span></div><div class=mt-3><span class=post-meta><i class="iconfont icon-date-fill" aria-hidden=true></i> <time datetime="2022-09-03 16:24" pubdate>2022å¹´9æœˆ3æ—¥ ä¸‹åˆ</time></span></div><div class=mt-1><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 7.9k å­— </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 66 åˆ†é’Ÿ</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id=board-ctn><div id=board><article class="post-content mx-auto"><h1 style=display:none>dbsç»“é¡¹æŠ¥å‘Š</h1><div class=markdown-body><center><font size=10><bold>ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°å¯åŠ¨å¾®å‹è™šæ‹Ÿæœº</bold></font><br><br></center><h1 id=1-é¡¹ç›®å®ç°æ–¹æ¡ˆç ”ç©¶><a class=markdownIt-Anchor href=#1-é¡¹ç›®å®ç°æ–¹æ¡ˆç ”ç©¶></a> 1. ğŸ“½ é¡¹ç›®å®ç°æ–¹æ¡ˆç ”ç©¶:</h1><blockquote><p>å®ç°æ–¹æ¡ˆç»™å‡ºæ˜¯ä¸ºäº†æä¾›<font color=cyan>å¯å¤ç°æ€§</font></p></blockquote><table><thead><tr><th>é…ç½®</th><th>æè¿°</th></tr></thead><tbody><tr><td>å¤„ç†å™¨</td><td>AMDÂ® Ryzen 7 4800h with radeon graphics Ã— 16</td></tr><tr><td>å†…å­˜</td><td>32g</td></tr><tr><td>æ˜¾å¡</td><td>NVIDIA Corporation TU117M [GeForce GTX 1650 Ti Mobile] / NVIDIA GeForce GTX 1650 Ti/PCIe/SSE2</td></tr><tr><td>OS</td><td>Ubuntu 22.04 LTS</td></tr><tr><td>rustcç‰ˆæœ¬</td><td>rustc 1.62.1</td></tr></tbody></table><h2 id=11-å‚è€ƒç›®æ ‡-firecracker><a class=markdownIt-Anchor href=#11-å‚è€ƒç›®æ ‡-firecracker></a> 1.1 ğŸ² å‚è€ƒç›®æ ‡: <a target=_blank rel=noopener href=https://github.com/firecracker-microvm/firecracker>firecracker</a></h2><h3 id=111-æ„å»ºfirecracker><a class=markdownIt-Anchor href=#111-æ„å»ºfirecracker></a> 1.1.1 æ„å»º<code>firecracker</code></h3><blockquote><p>cargoçš„ä½¿ç”¨æ–‡æ¡£: <a target=_blank rel=noopener href=https://doc.rust-lang.org/cargo/index.html>https://doc.rust-lang.org/cargo/index.html</a></p><p>å¦‚æœéœ€è¦ç¼–è¯‘å…¶ä»–å¹³å°çš„crate, å¯èƒ½è¿˜éœ€è¦ç”¨rustupæ·»åŠ å¯¹åº”çš„toolchain, rustupçš„ä½¿ç”¨æ–‡æ¡£: <a target=_blank rel=noopener href=https://rust-lang.github.io/rustup/index.html>https://rust-lang.github.io/rustup/index.html</a></p></blockquote><ol><li>æ‹‰å–æºç :</li></ol><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><code class="hljs bash">git <span class=hljs-built_in>clone</span> https://github.com/firecracker-microvm/firecracker<br><span class=hljs-built_in>cd</span> firecracker<br></code></pre></td></tr></table></figure><ol start=2><li><p>é…ç½®ä¾èµ–</p><blockquote><p>æ„å»ºfirecrakerä¾èµ–äº<code>Docker</code>, æˆ‘çš„ä¸ªäººåšå®¢ä¸Šdockerçš„å®‰è£…ç¬”è®°å¯ä¾›å‚è€ƒ: <a href=https://www.torch-fan.site/2022/07/21/Ubuntu%E4%B8%8A%E4%BD%BF%E7%94%A8docker/ >Ubuntuä¸Šä½¿ç”¨Docker</a></p></blockquote></li></ol><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><code class="hljs bash">sudo apt install build-essential clang<br>cargo check <br></code></pre></td></tr></table></figure><ol start=3><li>æ„å»ºfirecracker</li></ol><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><code class="hljs bash">tools/devtool build<br><br><span class=hljs-comment># release</span><br>tools/devtool build --release<br></code></pre></td></tr></table></figure><h3 id=112-ä½¿ç”¨firecrackeråˆ›å»ºè™šæ‹Ÿæœº><a class=markdownIt-Anchor href=#112-ä½¿ç”¨firecrackeråˆ›å»ºè™šæ‹Ÿæœº></a> 1.1.2 ä½¿ç”¨<code>firecracker</code>åˆ›å»ºè™šæ‹Ÿæœº</h3><blockquote><p>å‚è€ƒèµ„æ–™: <a target=_blank rel=noopener href=https://github.com/firecracker-microvm/firecracker/blob/main/docs/getting-started.md>https://github.com/firecracker-microvm/firecracker/blob/main/docs/getting-started.md</a></p></blockquote><blockquote><p>äº‹å®ä¸Š, æŠ¥å‘Šçš„æœ€ç»ˆç›®çš„ç›®çš„å¹¶ä¸åœ¨äºæè¿°æ„å»ºfirecrakeræˆ–è€…ä½¿ç”¨dbsä¹‹ç±»çš„æ–¹å¼, è€Œæ˜¯å€ŸåŠ©å¯¹firecrakerçš„äº†è§£æ¥è¾…åŠ©ä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°ä»<code>DBS</code>ä¸­å¯åŠ¨ä¸€ä¸ªè™šæ‹Ÿæœº, å› æ­¤æ–‡æ¡£å™è¿°ä¸ä»¥çº¿æ€§è¿›è¡Œ, å°†è¿›è¡Œè·³è½¬, ä½“ç°æ€è€ƒçš„è¿‡ç¨‹.</p></blockquote><p>â€‹	ä½¿ç”¨firecrackeråˆ›å»ºè™šæ‹Ÿæœº, éœ€è¦è¿™äº›å†…å®¹:</p><ol><li><code>API socket</code></li></ol><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><code class="hljs bash">./firecracker --api-sock /tmp/firecracker.socket<br></code></pre></td></tr></table></figure><ol start=2><li><p><code>Linux kernel</code></p></li><li><p><code>rootfs</code></p></li></ol><p>â€‹	å› æ­¤å½“æˆ‘ä»¬å¼€å§‹äº†è§£<code>DBS</code>æ—¶, éœ€è¦å…³æ³¨<code>DBS</code>å·²ç»å…·å¤‡å’Œä¸å…·å¤‡çš„è¦ç´ ,</p><h2 id=12-æ›´è¿›ä¸€æ­¥><a class=markdownIt-Anchor href=#12-æ›´è¿›ä¸€æ­¥></a> 1.2 ğŸ¦Œ æ›´è¿›ä¸€æ­¥</h2><blockquote><p>ä¸Šé¢çš„æ­¥éª¤ä¸å­˜åœ¨ä»»ä½•å›°éš¾, ä½†æˆ‘ä»¬å¹¶ä¸å…³å¿ƒæ˜¯å¦åˆ›å»ºå¥½è™šæ‹Ÿæœº, è€Œå…³æ³¨åœ¨firecrackerä¸€å¼€å§‹æ˜¯å¦‚ä½•åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæœº</p></blockquote><h3 id=121-vmmçš„å¯¹å¤–æ¥å£><a class=markdownIt-Anchor href=#121-vmmçš„å¯¹å¤–æ¥å£></a> 1.2.1 VMMçš„å¯¹å¤–æ¥å£</h3><blockquote><p>å®šä½åˆ°<code>src/firecracker/src/main.rs</code>, å…³æ³¨åœ¨<code>api-sock</code>å‘½ä»¤è¡Œå‚æ•°</p></blockquote><p>firecrackerå¯¹è™šæ‹Ÿæœºè¿›è¡Œé…ç½®ä¸»è¦åˆ†ä¸º<font color=cyan><strong>ä¸¤ç§å½¢å¼</strong></font>:</p><ol><li>HTTP APIçš„è¯·æ±‚æ–¹å¼è¿›è¡Œé…ç½®(ä¹Ÿå¯ä»¥åŒæ—¶æŒ‡å®šé…ç½®æ–‡ä»¶)</li><li>é€šè¿‡æŒ‡å®šé…ç½®æ–‡ä»¶çš„æ–¹å¼è¿›è¡Œé…ç½®</li></ol><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br></pre></td><td class=code><pre><code class="hljs bash">rootfs_path=$(<span class=hljs-built_in>pwd</span>)<span class=hljs-string>&quot;/hello-rootfs.ext4&quot;</span><br>curl --unix-socket /tmp/firecracker.socket -i \<br>  -X PUT <span class=hljs-string>&#x27;http://localhost/drives/rootfs&#x27;</span> \<br>  -H <span class=hljs-string>&#x27;Accept: application/json&#x27;</span>           \<br>  -H <span class=hljs-string>&#x27;Content-Type: application/json&#x27;</span>     \<br>  -d <span class=hljs-string>&quot;&#123;</span><br><span class=hljs-string>        \&quot;drive_id\&quot;: \&quot;rootfs\&quot;,</span><br><span class=hljs-string>        \&quot;path_on_host\&quot;: \&quot;<span class=hljs-variable>$&#123;rootfs_path&#125;</span>\&quot;,</span><br><span class=hljs-string>        \&quot;is_root_device\&quot;: true,</span><br><span class=hljs-string>        \&quot;is_read_only\&quot;: false</span><br><span class=hljs-string>   &#125;&quot;</span><br><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br></pre></td><td class=code><pre><code class="hljs bash"><span class=hljs-comment># ä¸ä½¿ç”¨APIè¿›è¡Œé…ç½®, ä¼ å…¥é…ç½®æ–‡ä»¶</span><br>./firecracker --api-sock /tmp/firecracker.socket --config-file &lt;path_to_the_configuration_file&gt;<br></code></pre></td></tr></table></figure><blockquote><p>å¯¹äºDBSè€Œè¨€, é¡¹ç›®æœ€åˆç›®æ ‡æ˜¯é€šè¿‡å‘½ä»¤è¡Œå‚æ•°è¿›è¡Œå¯åŠ¨, è€Œä¸éœ€è¦kataçš„ç¯å¢ƒ, å› æ­¤æˆ‘ä»¬å¯ä»¥å…³æ³¨åœ¨ä½¿ç”¨é…ç½®æ–‡ä»¶åˆ›å»ºè™šæ‹Ÿæœºçš„ä»£ç é€»è¾‘éƒ¨åˆ†, å› æ­¤å¯ä»¥å…³æ³¨å‡½æ•°<code>run_without_api</code> <span class=katex><span class=katex-mathml><math><semantics><mrow><mo>â†’</mo></mrow><annotation encoding=application/x-tex>\rightarrow</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.36687em;vertical-align:0></span><span class=mrel>â†’</span></span></span></span> <code>VmResources::from_json</code></p></blockquote><h3 id=122-rootfså’Œlinux-kernelçš„ä½¿ç”¨æ–¹å¼><a class=markdownIt-Anchor href=#122-rootfså’Œlinux-kernelçš„ä½¿ç”¨æ–¹å¼></a> 1.2.2 rootfså’ŒLinux kernelçš„ä½¿ç”¨æ–¹å¼</h3><blockquote><p>è¦äº†è§£rootfså’ŒLinux kernelå¦‚ä½•è¢«ä½¿ç”¨äº†, éœ€è¦ä»<code>main.rs</code>çš„<code>run_without_api</code>ä¸­, æ·±å…¥åˆ°<code>build_microvm_from_json</code></p></blockquote><ul><li>kernelè¢«ä»¥<code>VmmConfig::block_devices</code>çš„å½¢å¼ä¼ å…¥</li><li>rootfsä½œä¸º<code>VmmConfig::block_devices</code>é…ç½®çš„ä¸€éƒ¨åˆ†è¿›è¡Œä¼ å…¥</li><li>è‡³äºå¯åŠ¨è™šæ‹Ÿæœºç­‰å‘½ä»¤, åˆ™å¯ä»¥HTTP APIå½¢å¼, ä¼ é€’ç»™<code>api_server/src/lib.rs</code>, æ¥å—è¯·æ±‚<code>/actions</code>çš„å‚æ•°, å¹¶å¯åŠ¨é…ç½®å¥½çš„è™šæ‹Ÿæœº</li></ul><blockquote><p>è‡³æ­¤, æˆ‘ä»¬å¯ä»¥å¸¦ç€ç–‘é—®, è¾¹å¼€å§‹å®ç°æˆ‘ä»¬çš„é¡¹ç›®éœ€æ±‚, è¾¹æµè§ˆäº†è§£firecrackeræ˜¯å¦‚ä½•å®ç°çš„.</p></blockquote><h1 id=2-é˜¶æ®µä¸€-åˆ›å»ºå‘½ä»¤è¡Œå‰ç«¯æ¥å£><a class=markdownIt-Anchor href=#2-é˜¶æ®µä¸€-åˆ›å»ºå‘½ä»¤è¡Œå‰ç«¯æ¥å£></a> 2. ğŸ”¨ é˜¶æ®µä¸€: åˆ›å»ºå‘½ä»¤è¡Œå‰ç«¯æ¥å£</h1><blockquote><p>ç”±äºrustç¼–ç¨‹ç»éªŒä¸å¤š, å› æ­¤å°½å¯èƒ½ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“, åœ¨å‘½ä»¤è¡Œè§£æä¸Š, é€‰ç”¨<a target=_blank rel=noopener href=https://github.com/clap-rs/clap>clap</a> (Dual-licensed under <code>Apache 2.0</code> or <code>MIT</code>, å¯¹äºDBSè€Œè¨€, æ­£å¥½å¯ä»¥ç”¨<code>Apache 2.0</code>)</p><p><code>clap</code>çš„ä½¿ç”¨æ–‡æ¡£: <a target=_blank rel=noopener href=https://docs.rs/clap/latest/clap/ >https://docs.rs/clap/latest/clap/</a></p></blockquote><h2 id=21-å‘½ä»¤è¡Œé…ç½®é¡¹><a class=markdownIt-Anchor href=#21-å‘½ä»¤è¡Œé…ç½®é¡¹></a> 2.1 ğŸ¨ å‘½ä»¤è¡Œé…ç½®é¡¹</h2><blockquote><p>ä»<a target=_blank rel=noopener href=https://github.com/kata-containers/kata-containers/tree/runtime-rs>kata-containers</a>çš„<code>runtime-rs</code>åˆ†æ”¯ä¸­, å¯ä»¥åœ¨<code>dragonball::vm::VmConfigInfo</code>ä¸­çœ‹åˆ°DBSä½¿ç”¨çš„è™šæ‹Ÿæœºé…ç½®.</p></blockquote><figure class="highlight rust"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br><span class=line>6</span><br><span class=line>7</span><br><span class=line>8</span><br><span class=line>9</span><br><span class=line>10</span><br><span class=line>11</span><br><span class=line>12</span><br><span class=line>13</span><br><span class=line>14</span><br><span class=line>15</span><br><span class=line>16</span><br><span class=line>17</span><br><span class=line>18</span><br><span class=line>19</span><br><span class=line>20</span><br><span class=line>21</span><br><span class=line>22</span><br><span class=line>23</span><br><span class=line>24</span><br><span class=line>25</span><br><span class=line>26</span><br><span class=line>27</span><br><span class=line>28</span><br><span class=line>29</span><br><span class=line>30</span><br><span class=line>31</span><br><span class=line>32</span><br><span class=line>33</span><br><span class=line>34</span><br></pre></td><td class=code><pre><code class="hljs rust"><span class=hljs-keyword>pub</span> <span class=hljs-keyword>struct</span> <span class="hljs-title class_">CpuTopology</span> &#123;<br>    <span class=hljs-comment>/// threads per core to indicate hyperthreading is enabled or not</span><br>    <span class=hljs-keyword>pub</span> threads_per_core: <span class=hljs-type>u8</span>,<br>    <span class=hljs-comment>/// cores per die to guide guest cpu topology init</span><br>    <span class=hljs-keyword>pub</span> cores_per_die: <span class=hljs-type>u8</span>,<br>    <span class=hljs-comment>/// dies per socket to guide guest cpu topology</span><br>    <span class=hljs-keyword>pub</span> dies_per_socket: <span class=hljs-type>u8</span>,<br>    <span class=hljs-comment>/// number of sockets</span><br>    <span class=hljs-keyword>pub</span> sockets: <span class=hljs-type>u8</span>,<br>&#125;<br><br><span class=hljs-meta>#[derive(Clone, Debug, PartialEq)]</span><br><span class=hljs-keyword>pub</span> <span class=hljs-keyword>struct</span> <span class="hljs-title class_">VmConfigInfo</span> &#123;<br>    <span class=hljs-comment>/// Number of vcpu to start.</span><br>    <span class=hljs-keyword>pub</span> vcpu_count: <span class=hljs-type>u8</span>,<br>    <span class=hljs-comment>/// Max number of vcpu can be added</span><br>    <span class=hljs-keyword>pub</span> max_vcpu_count: <span class=hljs-type>u8</span>,<br>    <span class=hljs-comment>/// cpu power management.</span><br>    <span class=hljs-keyword>pub</span> cpu_pm: <span class=hljs-type>String</span>,<br>    <span class=hljs-comment>/// cpu topology information</span><br>    <span class=hljs-keyword>pub</span> cpu_topology: CpuTopology,<br>    <span class=hljs-comment>/// vpmu support level</span><br>    <span class=hljs-keyword>pub</span> vpmu_feature: <span class=hljs-type>u8</span>,<br><br>    <span class=hljs-comment>/// Memory type that can be either hugetlbfs or shmem, default is shmem</span><br>    <span class=hljs-keyword>pub</span> mem_type: <span class=hljs-type>String</span>,<br>    <span class=hljs-comment>/// Memory file path</span><br>    <span class=hljs-keyword>pub</span> mem_file_path: <span class=hljs-type>String</span>,<br>    <span class=hljs-comment>/// The memory size in MiB.</span><br>    <span class=hljs-keyword>pub</span> mem_size_mib: <span class=hljs-type>usize</span>,<br><br>    <span class=hljs-comment>/// sock path</span><br>    <span class=hljs-keyword>pub</span> serial_path: <span class=hljs-type>Option</span>&lt;<span class=hljs-type>String</span>&gt;,<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨<code>clap</code>å®šä¹‰å‘½ä»¤è¡Œå‚æ•°åï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹:</p><table><thead><tr><th style=text-align:center>arguments</th><th style=text-align:center>required</th><th style=text-align:center>default value</th><th style=text-align:center>description</th></tr></thead><tbody><tr><td style=text-align:center><code>rootfs</code></td><td style=text-align:center>true</td><td style=text-align:center>-</td><td style=text-align:center>The path to rootfs image.</td></tr><tr><td style=text-align:center><code>kernel-path</code></td><td style=text-align:center>true</td><td style=text-align:center>-</td><td style=text-align:center>The path of kernel image (Only uncompressed kernel is supported for Dragonball).</td></tr><tr><td style=text-align:center><code>log-file</code></td><td style=text-align:center>false</td><td style=text-align:center><code>&quot;dbs-cli.log&quot;</code></td><td style=text-align:center>The path to log file</td></tr><tr><td style=text-align:center><code>log-level</code></td><td style=text-align:center>false</td><td style=text-align:center><code>&quot;Info&quot;</code></td><td style=text-align:center>The logging level.</td></tr><tr><td style=text-align:center><code>boot-args</code></td><td style=text-align:center>false</td><td style=text-align:center><code>console=ttyS0 tty0 reboot=k debug panic=1 pci=off root=/dev/vda1</code></td><td style=text-align:center>The boot arguments passed to the kernel.</td></tr><tr><td style=text-align:center><code>is-root</code></td><td style=text-align:center>false</td><td style=text-align:center><code>true</code></td><td style=text-align:center>Decide the device to be the root boot device or not.</td></tr><tr><td style=text-align:center><code>is-read-only</code></td><td style=text-align:center>false</td><td style=text-align:center><code>false</code></td><td style=text-align:center>The driver opened in read-only or not.</td></tr><tr><td style=text-align:center><code>vcpu</code></td><td style=text-align:center>false</td><td style=text-align:center><code>1</code></td><td style=text-align:center>The number of vcpu to start.</td></tr><tr><td style=text-align:center><code>max-vcpu</code></td><td style=text-align:center>false</td><td style=text-align:center><code>1</code></td><td style=text-align:center>The max number of vpu can be added.</td></tr><tr><td style=text-align:center><code>cpu-pm</code></td><td style=text-align:center>false</td><td style=text-align:center><code>0</code></td><td style=text-align:center>vpmu support level.</td></tr><tr><td style=text-align:center><code>threads-per-core</code></td><td style=text-align:center>false</td><td style=text-align:center><code>1</code></td><td style=text-align:center>Threads per core to indicate hyper-threading is enabled or not.</td></tr><tr><td style=text-align:center><code>cores-per-die</code></td><td style=text-align:center>false</td><td style=text-align:center><code>1</code></td><td style=text-align:center>Cores per die to guide guest cpu topology init.</td></tr><tr><td style=text-align:center><code>dies-per-socket</code></td><td style=text-align:center>false</td><td style=text-align:center><code>1</code></td><td style=text-align:center>Dies per socket to guide guest cpu topology.</td></tr><tr><td style=text-align:center><code>sockets</code></td><td style=text-align:center>false</td><td style=text-align:center><code>1</code></td><td style=text-align:center>The number of sockets.</td></tr><tr><td style=text-align:center><code>mem-type</code></td><td style=text-align:center>false</td><td style=text-align:center><code>shmem</code></td><td style=text-align:center>Memory type that can be either hugetlbfs or shmem.</td></tr><tr><td style=text-align:center><code>mem-file</code></td><td style=text-align:center>false</td><td style=text-align:center>``</td><td style=text-align:center>Memory file path.</td></tr><tr><td style=text-align:center><code>initrd-path</code></td><td style=text-align:center>false</td><td style=text-align:center><code>None</code></td><td style=text-align:center>The path of initrd.</td></tr></tbody></table><h2 id=22-å‚æ•°ç›¸å…³çš„æ³¨æ„äº‹é¡¹><a class=markdownIt-Anchor href=#22-å‚æ•°ç›¸å…³çš„æ³¨æ„äº‹é¡¹></a> 2.2 å‚æ•°ç›¸å…³çš„æ³¨æ„äº‹é¡¹:</h2><p>æ•´ä¸ªå‘½ä»¤è¡Œå‚æ•°æœ€ä¸ºå…³é”®çš„ä¸‰ä¸ªå‚æ•°æ˜¯<code>rootfs</code>, <code>kernel-path</code> å’Œ <code>boot-args</code>. ç”±äºä»å‘½ä»¤è¡Œç»ˆç«¯è¿›å…¥vmçš„consoleé‡‡ç”¨çš„æ–¹å¼æ˜¯å°†ttySxçš„è¾“å‡ºé‡å®šå‘åˆ°å½“å‰ç»ˆç«¯çš„stdout, å› æ­¤éœ€è¦ç¡®ä¿kernelæ”¯æŒserial consoleå¹¶ä¸”rootfsåœ¨æ„å»ºæ—¶éœ€è¦é…ç½®å¥½å¯åŠ¨ä¹‹åèƒ½å¤Ÿå¯åŠ¨å¯¹åº”ç»ˆç«¯, å¦åˆ™å°†æ— æ³•è¿›å…¥vm. å¯¹äº<code>boot-args</code>, <code>console=xx</code>å’Œ<code>root=&quot;dev/vda1&quot;</code> æ˜¯æ ¹æ®å¯¹åº”rootfsçš„è®¾ç½®æ¥çš„, å› æ­¤è™½ç„¶ä¸æ˜¯å¿…é¡»ç»™å‡ºçš„å‚æ•°, ä½†æ˜¯éœ€è¦è‡ªè¡ŒæŸ¥çœ‹æ˜¯å¦éœ€è¦æœ‰æ‰€ä¿®æ”¹ã€‚</p><h1 id=3-é˜¶æ®µäºŒ-é¡¹ç›®å®ç°æ€è·¯åŠé—®é¢˜è§£å†³><a class=markdownIt-Anchor href=#3-é˜¶æ®µäºŒ-é¡¹ç›®å®ç°æ€è·¯åŠé—®é¢˜è§£å†³></a> 3. ğŸ”¥ é˜¶æ®µäºŒï¼š é¡¹ç›®å®ç°æ€è·¯åŠé—®é¢˜è§£å†³</h1><h2 id=31-å‘½ä»¤è¡Œå‚æ•°><a class=markdownIt-Anchor href=#31-å‘½ä»¤è¡Œå‚æ•°></a> 3.1 å‘½ä»¤è¡Œå‚æ•°ï¼š</h2><p>â€‹	æ ¹æ®firecrakerå’Œkata-containerç°æœ‰ä»£ç ï¼Œç¡®å®šå¯åŠ¨è™šæ‹Ÿæœºå¿…å¤‡å‚æ•°åï¼Œä¾¿å¯ç›´æ¥ç”¨<code>clap</code>æä¾›çš„ä¸€äº›<code>derive</code>æ¥å®šä¹‰å‘½ä»¤è¡Œå‚æ•°ï¼Œå‚æ•°é¡¹è§ä¸Šè¡¨ï¼Œæš‚æ— é—®é¢˜å‡ºç°ã€‚</p><h2 id=32-è¿›å…¥vmç»ˆç«¯><a class=markdownIt-Anchor href=#32-è¿›å…¥vmç»ˆç«¯></a> 3.2 è¿›å…¥vmç»ˆç«¯ï¼š</h2><p>â€‹	åŸºäºç°æœ‰kata-containerçš„ä¸€äº›åˆ›å»ºvmã€å¯åŠ¨vmã€åˆ›å»ºè®¾å¤‡ç­‰APIï¼Œåªéœ€è¿›è¡Œç®€å•çš„ä¿®æ”¹è°ƒç”¨å³å¯å®Œæˆã€‚ä½†æ˜¯æœ€ååœ¨IOä¸Šå‡ºç°é—®é¢˜ï¼Œå…·ä½“å¯ä»¥æè¿°ä¸ºåˆ›å»ºvmçš„æ ‡å‡†è¾“å…¥è¾“å‡ºç»ˆç«¯æ—¶ï¼Œ<code>com1</code>æœªå°†è¾“å‡ºé‡å®šå‘åˆ°stdoutï¼Œå¯¼è‡´æ— æ³•ä¸vmè¿›è¡Œäº¤äº’ã€‚</p><p>â€‹	è§£å†³æ–¹æ³•ï¼Œä¸º<code>com1</code>è®¾ç½®è¾“å‡ºæµå¹¶é‡å®šå‘åˆ°<code>stdout</code>ï¼š</p><figure class="highlight rust"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><code class="hljs rust">device.<span class="hljs-title function_ invoke__">lock</span>().<span class="hljs-title function_ invoke__">unwrap</span>().<span class="hljs-title function_ invoke__">set_output_stream</span>(<span class="hljs-title function_ invoke__">Some</span>(<span class=hljs-type>Box</span>::<span class="hljs-title function_ invoke__">new</span>(std::io::<span class="hljs-title function_ invoke__">stdout</span>())));<br></code></pre></td></tr></table></figure><h2 id=33-åŸºæœ¬åŸç†-serial-console><a class=markdownIt-Anchor href=#33-åŸºæœ¬åŸç†-serial-console></a> 3.3 åŸºæœ¬åŸç†ï¼š <code>serial console</code></h2><ul><li><a target=_blank rel=noopener href=https://www.kernel.org/doc/html/latest/admin-guide/serial-console.html>Linux Serial Console â€” The Linux Kernel documentation</a></li><li><a target=_blank rel=noopener href=https://tldp.org/HOWTO/Serial-HOWTO-10.html>Serial HOWTO: Serial Port Devices /dev/ttyS2, etc. (tldp.org)</a></li></ul><blockquote><p>ä¸‹å›¾ä¸ºä¸²å£å¯¹åº”ç»ˆç«¯åä»¥åŠIOåœ°å€</p></blockquote><p><img src=https://s1.ax1x.com/2022/08/29/vfSKR1.png alt=""></p><p><code>kata-container</code>åœ¨<code>runtime-rs</code>åˆ†æ”¯ä¸‹ï¼Œcom2è¢«ç”¨æ¥è¾“å‡ºæ—¥å¿—ä¿¡æ¯ï¼ˆåŒæ—¶ä¹Ÿå°†dmesgä¹Ÿå†™å…¥loggeräº†ï¼‰ï¼Œå› æ­¤åªèƒ½ä½¿ç”¨è®¾å¤‡com1è¿æ¥åˆ°å¯¹åº”çš„ç»ˆç«¯ã€‚</p><blockquote><p><code>console=device,options</code> ç”¨æ¥æŒ‡å®šç»ˆç«¯çš„è¾“å‡ºï¼Œè¯¥å‚æ•°æ”¾åœ¨kernelçš„å¯åŠ¨å‚æ•°ä¸­ã€‚</p><p><code>device</code>å¯èƒ½çš„å€¼ä¸ºï¼š</p><figure class="highlight livecodeserver"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre></td><td class=code><pre><code class="hljs livecodeserver">tty0 <span class=hljs-keyword>for</span> <span class=hljs-keyword>the</span> foreground virtual console<br>                ttyX <span class=hljs-keyword>for</span> <span class=hljs-keyword>any</span> other virtual console<br>                ttySx <span class=hljs-keyword>for</span> <span class=hljs-keyword>a</span> serial port<br>                lp0 <span class=hljs-keyword>for</span> <span class=hljs-keyword>the</span> <span class=hljs-keyword>first</span> parallel port<br>                ttyUSB0 <span class=hljs-keyword>for</span> <span class=hljs-keyword>the</span> <span class=hljs-keyword>first</span> USB serial device<br></code></pre></td></tr></table></figure></blockquote><p>åœ¨<code>kata-container</code>ä»“åº“<code>runtime-rs</code>åˆ†æ”¯çš„ç°æœ‰ä»£ç ä¸‹ï¼Œå·²ç»æœ‰é€šè¿‡socketè¿›å…¥serial consoleçš„ä»£ç ï¼Œä½†æ˜¯ä»å‘½ä»¤è¡Œå°†stdioé‡å®šå‘åˆ°è™šæ‹Ÿæœºserial consoleçš„ä»£ç å´ä¸èƒ½è¾¾åˆ°æ­£å¸¸é¢„æœŸã€‚åœ¨é€šè¿‡åå¤æµè§ˆä»£ç ï¼Œé€šè¿‡<code>3.2</code>ä¸­çš„ä¿®æ”¹ï¼Œè§£å†³äº†æ— æ³•åˆ›å»ºstdio consoleçš„é—®é¢˜ï¼Œå†åŠ ä¸Šæ­¤å‰å®ç°çš„å‘½ä»¤è¡Œå‚æ•°è§£æï¼Œæ•´ä¸ªæµç¨‹å°±å·²ç»å®Œæˆäº†ã€‚</p><h1 id=4-é¡¹ç›®æˆæœå±•ç¤º><a class=markdownIt-Anchor href=#4-é¡¹ç›®æˆæœå±•ç¤º></a> 4. é¡¹ç›®æˆæœå±•ç¤ºï¼š</h1><h2 id=41-æœ¬åœ°å¼€å‘ä»“åº“><a class=markdownIt-Anchor href=#41-æœ¬åœ°å¼€å‘ä»“åº“></a> 4.1 æœ¬åœ°å¼€å‘ä»“åº“ï¼š</h2><p>ä»“åº“åœ°å€ï¼š <a target=_blank rel=noopener href=https://github.com/QiliangFan/kata-containers>https://github.com/QiliangFan/kata-containers</a></p><p>åˆ†æ”¯ï¼š<code>runtime-rs</code></p><h2 id=42-pull-request><a class=markdownIt-Anchor href=#42-pull-request></a> 4.2 pull request:</h2><ul><li><p><a target=_blank rel=noopener href=https://github.com/openanolis/dbs-cli/pull/1>Create VM from command line arguments #1</a></p></li><li><p><a target=_blank rel=noopener href=https://github.com/kata-containers/kata-containers/pull/5082>dragonball: Fix problem that stdio console cannot connect to stdout #5082</a></p></li></ul><h2 id=43-è¿è¡Œç¤ºä¾‹ä¸ç»“æœæˆªå›¾><a class=markdownIt-Anchor href=#43-è¿è¡Œç¤ºä¾‹ä¸ç»“æœæˆªå›¾></a> 4.3 è¿è¡Œç¤ºä¾‹ä¸ç»“æœæˆªå›¾:</h2><blockquote><p>ä¸ºäº†ç»“æœæ˜“äºå¤ç°ï¼Œä½¿ç”¨äº†firecrakeré¡¹ç›®çš„kernelå’Œrootfs(æ–¹ä¾¿ç”¨æˆ·ä¸‹è½½ï¼Œ å½“ç„¶å…¶ä»–æ”¯æŒserial consoleçš„å†…æ ¸å’Œrootfsä¹Ÿå¯ä»¥)ï¼Œå¦‚éœ€è¿è¡Œæ­¤CLIï¼Œå¯å‰å¾€<a target=_blank rel=noopener href=https://github.com/firecracker-microvm/firecracker/blob/main/docs/getting-started.md>firecracker/getting-started.md at main Â· firecracker-microvm/firecracker (github.com)</a>ä¸‹è½½å¹¶ä½¿ç”¨</p></blockquote><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br></pre></td><td class=code><pre><code class="hljs bash">./dbs-cli --kernel-path ~/data/build/dbs/firecracker/vmlinux.bin --rootfs ~/data/build/dbs/firecracker/bionic.rootfs.ext4 --boot-args <span class=hljs-string>&quot;console=ttyS0 tty0 reboot=k debug panic=1 pci=off root=/dev/vda&quot;</span><br></code></pre></td></tr></table></figure><p><img src=https://s1.ax1x.com/2022/08/27/vRc536.png alt=è¿›å…¥vm></p><p><img src=https://s1.ax1x.com/2022/08/27/vRczgf.png alt=è¾“å…¥æŒ‡ä»¤></p><h2 id=44-å¯é€šè¿‡å‘½ä»¤è¡Œé…ç½®çš„å‚æ•°><a class=markdownIt-Anchor href=#44-å¯é€šè¿‡å‘½ä»¤è¡Œé…ç½®çš„å‚æ•°></a> 4.4 å¯é€šè¿‡å‘½ä»¤è¡Œé…ç½®çš„å‚æ•°ï¼š</h2><table><thead><tr><th style=text-align:center>arguments</th><th style=text-align:center>required</th><th style=text-align:center>default value</th><th style=text-align:center>description</th></tr></thead><tbody><tr><td style=text-align:center><code>rootfs</code></td><td style=text-align:center>true</td><td style=text-align:center>-</td><td style=text-align:center>The path to rootfs image.</td></tr><tr><td style=text-align:center><code>kernel-path</code></td><td style=text-align:center>true</td><td style=text-align:center>-</td><td style=text-align:center>The path of kernel image (Only uncompressed kernel is supported for Dragonball).</td></tr><tr><td style=text-align:center><code>log-file</code></td><td style=text-align:center>false</td><td style=text-align:center><code>&quot;dbs-cli.log&quot;</code></td><td style=text-align:center>The path to log file</td></tr><tr><td style=text-align:center><code>log-level</code></td><td style=text-align:center>false</td><td style=text-align:center><code>&quot;Info&quot;</code></td><td style=text-align:center>The logging level.</td></tr><tr><td style=text-align:center><code>boot-args</code></td><td style=text-align:center>false</td><td style=text-align:center><code>console=ttyS0 tty0 reboot=k debug panic=1 pci=off root=/dev/vda1</code></td><td style=text-align:center>The boot arguments passed to the kernel.</td></tr><tr><td style=text-align:center><code>is-root</code></td><td style=text-align:center>false</td><td style=text-align:center><code>true</code></td><td style=text-align:center>Decide the device to be the root boot device or not.</td></tr><tr><td style=text-align:center><code>is-read-only</code></td><td style=text-align:center>false</td><td style=text-align:center><code>false</code></td><td style=text-align:center>The driver opened in read-only or not.</td></tr><tr><td style=text-align:center><code>vcpu</code></td><td style=text-align:center>false</td><td style=text-align:center><code>1</code></td><td style=text-align:center>The number of vcpu to start.</td></tr><tr><td style=text-align:center><code>max-vcpu</code></td><td style=text-align:center>false</td><td style=text-align:center><code>1</code></td><td style=text-align:center>The max number of vpu can be added.</td></tr><tr><td style=text-align:center><code>cpu-pm</code></td><td style=text-align:center>false</td><td style=text-align:center><code>0</code></td><td style=text-align:center>vpmu support level.</td></tr><tr><td style=text-align:center><code>threads-per-core</code></td><td style=text-align:center>false</td><td style=text-align:center><code>1</code></td><td style=text-align:center>Threads per core to indicate hyper-threading is enabled or not.</td></tr><tr><td style=text-align:center><code>cores-per-die</code></td><td style=text-align:center>false</td><td style=text-align:center><code>1</code></td><td style=text-align:center>Cores per die to guide guest cpu topology init.</td></tr><tr><td style=text-align:center><code>dies-per-socket</code></td><td style=text-align:center>false</td><td style=text-align:center><code>1</code></td><td style=text-align:center>Dies per socket to guide guest cpu topology.</td></tr><tr><td style=text-align:center><code>sockets</code></td><td style=text-align:center>false</td><td style=text-align:center><code>1</code></td><td style=text-align:center>The number of sockets.</td></tr><tr><td style=text-align:center><code>mem-type</code></td><td style=text-align:center>false</td><td style=text-align:center><code>shmem</code></td><td style=text-align:center>Memory type that can be either hugetlbfs or shmem.</td></tr><tr><td style=text-align:center><code>mem-file</code></td><td style=text-align:center>false</td><td style=text-align:center>``</td><td style=text-align:center>Memory file path.</td></tr><tr><td style=text-align:center><code>initrd-path</code></td><td style=text-align:center>false</td><td style=text-align:center><code>None</code></td><td style=text-align:center>The path of initrd.</td></tr></tbody></table><h2 id=45-ä½¿ç”¨ç¤ºä¾‹><a class=markdownIt-Anchor href=#45-ä½¿ç”¨ç¤ºä¾‹></a> 4.5 ä½¿ç”¨ç¤ºä¾‹:</h2><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><code class="hljs bash">./dbs-cli \<br>  --kernel-path ~/data/build/dbs/vmlinux.bin \<br>  --rootfs ~/data/build/dbs/rootfs.dmg \<br>  --boot-args <span class=hljs-string>&quot;console=ttyS0 tty0 reboot=k debug panic=1 pci=off root=/dev/vda1&quot;</span> ;<br></code></pre></td></tr></table></figure><p>For the rootfs from firecracker:</p><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><code class="hljs bash">./dbs-cli \<br>  --kernel-path ~/data/build/dbs/vmlinux.bin \<br>  --rootfs ~/data/build/dbs/bionic.rootfs.ext4 \<br>  --boot-args <span class=hljs-string>&quot;console=ttyS0 tty0 reboot=k debug panic=1 pci=off root=/dev/vda&quot;</span> ;<br></code></pre></td></tr></table></figure><p>For the rootfs build from kata:</p><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br></pre></td><td class=code><pre><code class="hljs bash">./dbs-cli \<br>  --kernel-path ~/data/build/dbs/vmlinux.bin \<br>  --rootfs ~/data/build/dbs/kata-containers.img \<br>  --boot-args <span class=hljs-string>&quot;console=ttyS0 tty0 reboot=k debug panic=1 pci=off root=/dev/vda1&quot;</span> ;<br></code></pre></td></tr></table></figure><p>Set the log level and log file:</p><blockquote><p>The log-level argument is case-insensitive: ErrOR and InFO are valid.</p></blockquote><figure class="highlight bash"><table><tr><td class=gutter><pre><span class=line>1</span><br><span class=line>2</span><br><span class=line>3</span><br><span class=line>4</span><br><span class=line>5</span><br></pre></td><td class=code><pre><code class="hljs bash">./dbs-cli \<br>  --log-file dbs-cli.log --log-level ERROR \<br>  --kernel-path ~/data/build/dbs/vmlinux.bin \<br>  --rootfs ~/data/build/dbs/kata-containers.img \<br>  --boot-args <span class=hljs-string>&quot;console=ttyS0 tty0 reboot=k debug panic=1 pci=off root=/dev/vda1&quot;</span> ;<br></code></pre></td></tr></table></figure></div><hr><div><div class="post-metas my-3"><div class=post-meta><i class="iconfont icon-tags"></i> <a href=/tags/%E6%8A%A5%E5%91%8A/ >#æŠ¥å‘Š</a></div></div><div class="license-box my-3"><div class=license-title><div>dbsç»“é¡¹æŠ¥å‘Š</div><div>https://www.torch-fan.site/2022/09/03/dbsç»“é¡¹æŠ¥å‘Š/</div></div><div class=license-meta><div class=license-meta-item><div>ä½œè€…</div><div>Torch-Fan</div></div><div class="license-meta-item license-meta-date"><div>å‘å¸ƒäº</div><div>2022å¹´9æœˆ3æ—¥</div></div><div class="license-meta-item license-meta-date"><div>æ›´æ–°äº</div><div>2022å¹´11æœˆ15æ—¥</div></div><div class=license-meta-item><div>è®¸å¯åè®®</div><div><a target=_blank href=https://creativecommons.org/licenses/by/4.0/ ><span class="hint--top hint--rounded" aria-label="BY - ç½²å"><i class="iconfont icon-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href=/2022/09/04/Generate-204%E9%93%BE%E6%8E%A5%E6%94%B6%E9%9B%86/ title="Generate 204é“¾æ¥æ”¶é›†"><i class="iconfont icon-arrowleft"></i> <span class=hidden-mobile>Generate 204é“¾æ¥æ”¶é›†</span> <span class=visible-mobile>ä¸Šä¸€ç¯‡</span></a></article><article class="post-next col-6"><a href=/2022/08/24/Linux%E4%B8%AA%E4%BA%BA%E4%BD%BF%E7%94%A8%E6%8C%87%E4%BB%A4%E6%94%B6%E9%9B%86/ title=Linuxä¸ªäººä½¿ç”¨æŒ‡ä»¤æ”¶é›†><span class=hidden-mobile>Linuxä¸ªäººä½¿ç”¨æŒ‡ä»¤æ”¶é›†</span> <span class=visible-mobile>ä¸‹ä¸€ç¯‡</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id=comments><script type=text/javascript nonce=3>Fluid.utils.loadComments("#comments",function(){var t="github-light",e="github-dark",i="dark"===document.documentElement.getAttribute("data-user-color-scheme")?e:t,t=(window.UtterancesThemeLight=t,window.UtterancesThemeDark=e,document.createElement("script"));t.setAttribute("src","https://utteranc.es/client.js"),t.setAttribute("repo","QiliangFan/qiliangfan.github.io"),t.setAttribute("issue-term","title"),t.setAttribute("label","BlogComment"),t.setAttribute("theme",i),t.setAttribute("crossorigin","anonymous"),document.getElementById("comments").appendChild(t)})</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class=sidebar style=margin-left:-1rem><div id=toc><p class=toc-header><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p><div class=toc-body id=toc-body></div></div></aside></div></div></div><a id=scroll-top-button aria-label=TOP href=# role=button><i class="iconfont icon-arrowup" aria-hidden=true></i></a><div class="modal fade" id=modalSearch tabindex=-1 role=dialog aria-labelledby=ModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-lg" role=document><div class=modal-content><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4><button type=button id=local-search-close class=close data-dismiss=modal aria-label=Close><span aria-hidden=true>&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type=text id=local-search-input class="form-control validate"> <label data-error=x data-success=v for=local-search-input>å…³é”®è¯</label></div><div class=list-group id=local-search-result></div></div></div></div></div></main><footer><div class=footer-inner><div class=footer-content><a href=https://hexo.io target=_blank rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href=https://github.com/fluid-dev/hexo-theme-fluid target=_blank rel="nofollow noopener"><span>Fluid</span></a></div></div></footer><script src=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js></script><link rel=stylesheet href=https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css><script nonce=5>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src=https://lib.baomitu.com/jquery/3.6.0/jquery.min.js></script><script src=https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js></script><script src=/js/events.js></script><script src=/js/plugins.js></script><script src=https://lib.baomitu.com/typed.js/2.0.12/typed.min.js></script><script nonce=6>!function(t){var e=Fluid.plugins.typing,t=t.getElementById("subtitle");t&&e&&e(t.getAttribute("data-typed-text"))}((window,document))</script><script src=/js/img-lazyload.js></script><script nonce=12>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.18.0/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init({tocSelector:"#toc-body",contentSelector:".markdown-body",headingSelector:CONFIG.toc.headingSelector||"h1,h2,h3,h4,h5,h6",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",collapseDepth:CONFIG.toc.collapseDepth||0,scrollSmooth:!0,headingsOffset:-t}),0<o.find(".toc-list-item").length)&&o.css("visibility","visible")})</script><script nonce=8>!function(){var n,i=CONFIG.code_language.enable&&CONFIG.code_language.default,t=CONFIG.copy_btn;(i||t)&&(n="",n=(n+='<div class="code-widget">')+"LANG"+"</div>",jQuery(".markdown-body pre").each(function(){var e,a=jQuery(this);0<a.find("code.mermaid").length||0<a.find("span.line").length||(e="",i&&(e=CONFIG.code_language.default,0<a[0].children.length&&2<=a[0].children[0].classList.length&&a.children().hasClass("hljs")?e=a[0].children[0].classList[1]:a[0].getAttribute("data-language")?e=a[0].getAttribute("data-language"):a.parent().hasClass("sourceCode")&&0<a[0].children.length&&2<=a[0].children[0].classList.length?(e=a[0].children[0].classList[1],a.parent().addClass("code-wrapper")):a.parent().hasClass("markdown-body")&&0===a[0].classList.length&&a.wrap('<div class="code-wrapper"></div>'),e=e.toUpperCase().replace("NONE",CONFIG.code_language.default)),a.append(n.replace("LANG",e).replace('code-widget">',(e=a[0],(0<=Fluid.utils.getBackgroundLightness(e)?"code-widget-light":"code-widget-dark")+(t?' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>':' code-widget">')))),t&&Fluid.utils.createScript("https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js",function(){new window.ClipboardJS(".copy-btn",{target:function(e){for(var a=e.parentNode.childNodes,n=0;n<a.length;n++)if("CODE"===a[n].tagName)return a[n]}}).on("success",function(e){e.clearSelection(),e.trigger.innerHTML=e.trigger.innerHTML.replace("icon-copy","icon-success"),setTimeout(function(){e.trigger.innerHTML=e.trigger.innerHTML.replace("icon-success","icon-copy")},2e3)})}))}))}()</script><script nonce=10>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var o,n=[];for(o of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))n.push(".markdown-body > "+o.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(n.join(", "))})</script><script nonce=11>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script nonce=14>Fluid.plugins.imageCaption()</script><script src=/js/local-search.js></script><script src=/js/boot.js></script><noscript><div class=noscript-warning>åšå®¢åœ¨å…è®¸ JavaScript è¿è¡Œçš„ç¯å¢ƒä¸‹æµè§ˆæ•ˆæœæ›´ä½³</div></noscript></body></html>